<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EM1 Game Board v2.0 - –¢–µ—Å—Ç –≤—Å–µ—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #0f1419 0%, #1a1d24 25%, #242830 50%, #1a1d24 75%, #0f1419 100%);
            color: #ffffff;
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
        }

        .test-container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 30px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .test-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .test-header h1 {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, #00e5ff 0%, #ff00ff 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .test-header p {
            font-size: 1.1rem;
            color: rgba(255, 255, 255, 0.7);
        }

        .test-sections {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .test-section {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .test-section:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        .test-section h2 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: #00e5ff;
        }

        .test-buttons {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .test-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 20px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .test-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }

        .test-btn.success {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
        }

        .test-btn.error {
            background: linear-gradient(135deg, #f44336 0%, #da190b 100%);
        }

        .test-btn.warning {
            background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%);
        }

        .test-results {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            padding: 25px;
            margin-top: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .test-results h3 {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: #ff00ff;
        }

        .log-entry {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 10px;
            border-left: 4px solid #00e5ff;
            font-family: 'Courier New', monospace;
            font-size: 13px;
        }

        .log-entry.success {
            border-left-color: #4CAF50;
            background: rgba(76, 175, 80, 0.1);
        }

        .log-entry.error {
            border-left-color: #f44336;
            background: rgba(244, 67, 54, 0.1);
        }

        .log-entry.warning {
            border-left-color: #ff9800;
            background: rgba(255, 152, 0, 0.1);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 800;
            color: #00e5ff;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.7);
        }

        .clear-btn {
            background: linear-gradient(135deg, #f44336 0%, #da190b 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            margin-top: 20px;
            transition: all 0.3s ease;
        }

        .clear-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
        }

        @media (max-width: 768px) {
            .test-sections {
                grid-template-columns: 1fr;
            }
            
            .test-header h1 {
                font-size: 2rem;
            }
            
            .test-container {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="test-header">
            <h1>üéÆ EM1 Game Board v2.0</h1>
            <p>–ö–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∏–≥—Ä–æ–≤—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤</p>
        </div>

        <div class="test-sections">
            <!-- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã -->
            <div class="test-section">
                <h2>üöÄ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã</h2>
                <div class="test-buttons">
                    <button class="test-btn" onclick="testSystemInit()">
                        <span>‚öôÔ∏è</span> –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å GameCore
                    </button>
                    <button class="test-btn" onclick="testModulesLoad()">
                        <span>üì¶</span> –ó–∞–≥—Ä—É–∑–∏—Ç—å –º–æ–¥—É–ª–∏
                    </button>
                    <button class="test-btn" onclick="testEventBus()">
                        <span>üì°</span> –¢–µ—Å—Ç EventBus
                    </button>
                </div>
            </div>

            <!-- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–≥—Ä–æ–≤–æ–≥–æ –ø–æ–ª—è -->
            <div class="test-section">
                <h2>üéØ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–≥—Ä–æ–≤–æ–≥–æ –ø–æ–ª—è</h2>
                <div class="test-buttons">
                    <button class="test-btn" onclick="testCellGenerator()">
                        <span>üèóÔ∏è</span> –°–æ–∑–¥–∞—Ç—å –∏–≥—Ä–æ–≤—ã–µ –∫–ª–µ—Ç–∫–∏
                    </button>
                    <button class="test-btn" onclick="testBoardLayout()">
                        <span>üó∫Ô∏è</span> –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–∞–∫–µ—Ç –ø–æ–ª—è
                    </button>
                    <button class="test-btn" onclick="testCellTypes()">
                        <span>üé®</span> –¢–µ—Å—Ç —Ç–∏–ø–æ–≤ –∫–ª–µ—Ç–æ–∫
                    </button>
                </div>
            </div>

            <!-- –°–∏—Å—Ç–µ–º–∞ —Ö–æ–¥–æ–≤ -->
            <div class="test-section">
                <h2>üé≤ –°–∏—Å—Ç–µ–º–∞ —Ö–æ–¥–æ–≤</h2>
                <div class="test-buttons">
                    <button class="test-btn" onclick="testTurnController()">
                        <span>üîÑ</span> –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å TurnController
                    </button>
                    <button class="test-btn" onclick="testDiceRoll()">
                        <span>üé≤</span> –ë—Ä–æ—Å–æ–∫ –∫—É–±–∏–∫–∞
                    </button>
                    <button class="test-btn" onclick="testPlayerMovement()">
                        <span>üë§</span> –î–≤–∏–∂–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞
                    </button>
                </div>
            </div>

            <!-- –ò–≥—Ä–æ–≤–æ–π –ø—Ä–æ—Ü–µ—Å—Å -->
            <div class="test-section">
                <h2>üéÆ –ò–≥—Ä–æ–≤–æ–π –ø—Ä–æ—Ü–µ—Å—Å</h2>
                <div class="test-buttons">
                    <button class="test-btn" onclick="testGameFlow()">
                        <span>üéØ</span> –ó–∞–ø—É—Å—Ç–∏—Ç—å GameFlowController
                    </button>
                    <button class="test-btn" onclick="testFullTurn()">
                        <span>‚ö°</span> –ü–æ–ª–Ω—ã–π –∏–≥—Ä–æ–≤–æ–π —Ö–æ–¥
                    </button>
                    <button class="test-btn" onclick="testEventProcessing()">
                        <span>üìã</span> –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π
                    </button>
                </div>
            </div>

            <!-- –ò–≥—Ä–æ–∫–∏ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ -->
            <div class="test-section">
                <h2>üë• –ò–≥—Ä–æ–∫–∏ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ</h2>
                <div class="test-buttons">
                    <button class="test-btn" onclick="testPlayerManager()">
                        <span>üë§</span> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞–º–∏
                    </button>
                    <button class="test-btn" onclick="testStateManager()">
                        <span>üíæ</span> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º
                    </button>
                    <button class="test-btn" onclick="testPlayerStats()">
                        <span>üìä</span> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–≥—Ä–æ–∫–æ–≤
                    </button>
                </div>
            </div>

            <!-- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã -->
            <div class="test-section">
                <h2>üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã</h2>
                <div class="test-buttons">
                    <button class="test-btn" onclick="testFullGame()">
                        <span>üé™</span> –ü–æ–ª–Ω–∞—è –∏–≥—Ä–∞ (3 —Ö–æ–¥–∞)
                    </button>
                    <button class="test-btn" onclick="testMultiplePlayers()">
                        <span>üë•</span> –ú—É–ª—å—Ç–∏–ø–ª–µ–µ—Ä (4 –∏–≥—Ä–æ–∫–∞)
                    </button>
                    <button class="test-btn" onclick="testPerformance()">
                        <span>‚ö°</span> –¢–µ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
                    </button>
                </div>
            </div>
        </div>

        <div class="test-results">
            <h3>üìã –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</h3>
            <div id="testLogs"></div>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="totalTests">0</div>
                    <div class="stat-label">–í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="passedTests">0</div>
                    <div class="stat-label">–£—Å–ø–µ—à–Ω—ã—Ö</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="failedTests">0</div>
                    <div class="stat-label">–ù–µ—É–¥–∞—á–Ω—ã—Ö</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="testTime">0ms</div>
                    <div class="stat-label">–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</div>
                </div>
            </div>

            <button class="clear-btn" onclick="clearResults()">
                üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
            </button>
        </div>
    </div>

    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º –∏–≥—Ä–æ–≤—ã–µ –º–æ–¥—É–ª–∏ -->
    <script type="module">
        // –ò–º–ø–æ—Ä—Ç—ã –∏–≥—Ä–æ–≤—ã—Ö –º–æ–¥—É–ª–µ–π
        let GameCore, CellGenerator, TurnController, GameFlowController, DiceModule, MovementModule, EventModule, PlayerManager, StateManager, ModuleManager, EventBus;

        // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–µ—Å—Ç–æ–≤
        let testStats = {
            total: 0,
            passed: 0,
            failed: 0,
            startTime: null
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥—É–ª–µ–π
        async function initModules() {
            try {
                const { GameCore: GC } = await import('./assets/js/core/GameCore.js');
                GameCore = GC;

                const { CellGenerator: CG } = await import('./assets/js/modules/game/CellGenerator.js');
                CellGenerator = CG;

                const { TurnController: TC } = await import('./assets/js/modules/game/TurnController.js');
                TurnController = TC;

                const { GameFlowController: GFC } = await import('./assets/js/modules/game/GameFlowController.js');
                GameFlowController = GFC;

                const { DiceModule: DM } = await import('./assets/js/modules/DiceModule.js');
                DiceModule = DM;

                const { MovementModule: MM } = await import('./assets/js/modules/MovementModule.js');
                MovementModule = MM;

                const { EventModule: EM } = await import('./assets/js/modules/EventModule.js');
                EventModule = EM;

                const { PlayerManager: PM } = await import('./assets/js/core/PlayerManager.js');
                PlayerManager = PM;

                const { StateManager: SM } = await import('./assets/js/core/StateManager.js');
                StateManager = SM;

                const { ModuleManager: MM2 } = await import('./assets/js/core/ModuleManager.js');
                ModuleManager = MM2;

                const { EventBus: EB } = await import('./assets/js/services/EventBus.js');
                EventBus = EB;

                logResult('‚úÖ –í—Å–µ –º–æ–¥—É–ª–∏ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã', 'success');
                return true;
            } catch (error) {
                logResult(`‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥—É–ª–µ–π: ${error.message}`, 'error');
                return false;
            }
        }

        // –§—É–Ω–∫—Ü–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        window.testSystemInit = async function() {
            startTest();
            try {
                const gameCore = new GameCore();
                await gameCore.init();
                logResult('‚úÖ GameCore –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω —É—Å–ø–µ—à–Ω–æ', 'success');
                window.gameCore = gameCore;
                passTest();
            } catch (error) {
                logResult(`‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ GameCore: ${error.message}`, 'error');
                failTest();
            }
        };

        window.testModulesLoad = async function() {
            startTest();
            try {
                if (!window.gameCore) {
                    throw new Error('GameCore –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
                }
                const modules = window.gameCore.modules.getAll();
                logResult(`‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ –º–æ–¥—É–ª–µ–π: ${Object.keys(modules).length}`, 'success');
                Object.keys(modules).forEach(moduleName => {
                    logResult(`  - ${moduleName}`, 'success');
                });
                passTest();
            } catch (error) {
                logResult(`‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥—É–ª–µ–π: ${error.message}`, 'error');
                failTest();
            }
        };

        window.testEventBus = async function() {
            startTest();
            try {
                const eventBus = new EventBus();
                let eventReceived = false;
                
                eventBus.on('testEvent', () => {
                    eventReceived = true;
                });
                
                eventBus.emit('testEvent');
                
                setTimeout(() => {
                    if (eventReceived) {
                        logResult('‚úÖ EventBus —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ', 'success');
                        passTest();
                    } else {
                        logResult('‚ùå EventBus –Ω–µ –ø–æ–ª—É—á–∏–ª —Å–æ–±—ã—Ç–∏–µ', 'error');
                        failTest();
                    }
                }, 100);
            } catch (error) {
                logResult(`‚ùå –û—à–∏–±–∫–∞ EventBus: ${error.message}`, 'error');
                failTest();
            }
        };

        window.testCellGenerator = async function() {
            startTest();
            try {
                const cellGenerator = new CellGenerator(window.gameCore || {});
                const cells = cellGenerator.generateGameBoard();
                logResult(`‚úÖ –°–æ–∑–¥–∞–Ω–æ –∫–ª–µ—Ç–æ–∫: ${cells.length}`, 'success');
                logResult(`  - –¢–∏–ø—ã –∫–ª–µ—Ç–æ–∫: ${[...new Set(cells.map(c => c.type))].join(', ')}`, 'success');
                passTest();
            } catch (error) {
                logResult(`‚ùå –û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–ª–µ—Ç–æ–∫: ${error.message}`, 'error');
                failTest();
            }
        };

        window.testBoardLayout = async function() {
            startTest();
            try {
                const cellGenerator = new CellGenerator(window.gameCore || {});
                const cells = cellGenerator.generateGameBoard();
                
                if (cells.length === 44) {
                    logResult('‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–µ—Ç–æ–∫: 44', 'success');
                } else {
                    logResult(`‚ö†Ô∏è –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–µ—Ç–æ–∫: ${cells.length} (–æ–∂–∏–¥–∞–µ—Ç—Å—è 44)`, 'warning');
                }
                
                const cellTypes = [...new Set(cells.map(c => c.type))];
                logResult(`‚úÖ –¢–∏–ø—ã –∫–ª–µ—Ç–æ–∫: ${cellTypes.join(', ')}`, 'success');
                passTest();
            } catch (error) {
                logResult(`‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –º–∞–∫–µ—Ç–∞: ${error.message}`, 'error');
                failTest();
            }
        };

        window.testCellTypes = async function() {
            startTest();
            try {
                const cellGenerator = new CellGenerator(window.gameCore || {});
                const cells = cellGenerator.generateGameBoard();
                
                const expectedTypes = ['money', 'property', 'vehicle', 'idea', 'goal', 'shopping', 'business'];
                const foundTypes = [...new Set(cells.map(c => c.type))];
                
                expectedTypes.forEach(type => {
                    if (foundTypes.includes(type)) {
                        logResult(`‚úÖ –¢–∏–ø –∫–ª–µ—Ç–∫–∏ –Ω–∞–π–¥–µ–Ω: ${type}`, 'success');
                    } else {
                        logResult(`‚ö†Ô∏è –¢–∏–ø –∫–ª–µ—Ç–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω: ${type}`, 'warning');
                    }
                });
                
                passTest();
            } catch (error) {
                logResult(`‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–∏–ø–æ–≤: ${error.message}`, 'error');
                failTest();
            }
        };

        window.testTurnController = async function() {
            startTest();
            try {
                const turnController = new TurnController(window.gameCore || {});
                logResult('‚úÖ TurnController —Å–æ–∑–¥–∞–Ω —É—Å–ø–µ—à–Ω–æ', 'success');
                
                // –¢–µ—Å—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Ö–æ–¥–æ–≤
                const mockPlayers = [
                    { id: '1', name: '–ò–≥—Ä–æ–∫ 1' },
                    { id: '2', name: '–ò–≥—Ä–æ–∫ 2' }
                ];
                
                const turnOrder = turnController.initializeTurns(mockPlayers);
                logResult(`‚úÖ –ü–æ—Ä—è–¥–æ–∫ —Ö–æ–¥–æ–≤ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è ${turnOrder.length} –∏–≥—Ä–æ–∫–æ–≤`, 'success');
                passTest();
            } catch (error) {
                logResult(`‚ùå –û—à–∏–±–∫–∞ TurnController: ${error.message}`, 'error');
                failTest();
            }
        };

        window.testDiceRoll = async function() {
            startTest();
            try {
                const diceModule = new DiceModule();
                const result = diceModule.roll();
                
                if (result.total >= 2 && result.total <= 12) {
                    logResult(`‚úÖ –ë—Ä–æ—Å–æ–∫ –∫—É–±–∏–∫–∞: ${result.dice[0]} + ${result.dice[1]} = ${result.total}`, 'success');
                } else {
                    logResult(`‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±—Ä–æ—Å–∫–∞: ${result.total}`, 'error');
                    failTest();
                    return;
                }
                passTest();
            } catch (error) {
                logResult(`‚ùå –û—à–∏–±–∫–∞ –±—Ä–æ—Å–∫–∞ –∫—É–±–∏–∫–∞: ${error.message}`, 'error');
                failTest();
            }
        };

        window.testPlayerMovement = async function() {
            startTest();
            try {
                const movementModule = new MovementModule();
                const startPosition = 0;
                const steps = 5;
                
                const newPosition = movementModule.move(startPosition, steps, 44);
                
                if (newPosition === 5) {
                    logResult(`‚úÖ –î–≤–∏–∂–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞: ${startPosition} + ${steps} = ${newPosition}`, 'success');
                } else {
                    logResult(`‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ: ${startPosition} + ${steps} = ${newPosition}`, 'error');
                    failTest();
                    return;
                }
                passTest();
            } catch (error) {
                logResult(`‚ùå –û—à–∏–±–∫–∞ –¥–≤–∏–∂–µ–Ω–∏—è: ${error.message}`, 'error');
                failTest();
            }
        };

        window.testGameFlow = async function() {
            startTest();
            try {
                const gameFlowController = new GameFlowController(window.gameCore || {});
                logResult('‚úÖ GameFlowController —Å–æ–∑–¥–∞–Ω —É—Å–ø–µ—à–Ω–æ', 'success');
                passTest();
            } catch (error) {
                logResult(`‚ùå –û—à–∏–±–∫–∞ GameFlowController: ${error.message}`, 'error');
                failTest();
            }
        };

        window.testFullTurn = async function() {
            startTest();
            try {
                if (!window.gameCore) {
                    throw new Error('GameCore –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
                }
                
                // –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∏–≥—Ä–æ–∫–∞
                const testPlayer = { id: 'test1', name: '–¢–µ—Å—Ç–æ–≤—ã–π –∏–≥—Ä–æ–∫' };
                
                // –í—ã–ø–æ–ª–Ω—è–µ–º –ø–æ–ª–Ω—ã–π —Ö–æ–¥
                const result = await window.gameCore.executeTurn(testPlayer.id);
                
                logResult('‚úÖ –ü–æ–ª–Ω—ã–π –∏–≥—Ä–æ–≤–æ–π —Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ', 'success');
                logResult(`  - –†–µ–∑—É–ª—å—Ç–∞—Ç: ${JSON.stringify(result)}`, 'success');
                passTest();
            } catch (error) {
                logResult(`‚ùå –û—à–∏–±–∫–∞ –ø–æ–ª–Ω–æ–≥–æ —Ö–æ–¥–∞: ${error.message}`, 'error');
                failTest();
            }
        };

        window.testEventProcessing = async function() {
            startTest();
            try {
                const eventModule = new EventModule();
                const testEvent = {
                    type: 'payday',
                    amount: 1000,
                    player: 'test1'
                };
                
                const result = eventModule.processEvent(testEvent);
                logResult('‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞', 'success');
                logResult(`  - –†–µ–∑—É–ª—å—Ç–∞—Ç: ${JSON.stringify(result)}`, 'success');
                passTest();
            } catch (error) {
                logResult(`‚ùå –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏—è: ${error.message}`, 'error');
                failTest();
            }
        };

        window.testPlayerManager = async function() {
            startTest();
            try {
                const playerManager = new PlayerManager();
                const player = playerManager.addPlayer('test1', '–¢–µ—Å—Ç–æ–≤—ã–π –∏–≥—Ä–æ–∫');
                
                if (player && player.id === 'test1') {
                    logResult('‚úÖ PlayerManager —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ', 'success');
                    logResult(`  - –ò–≥—Ä–æ–∫ –¥–æ–±–∞–≤–ª–µ–Ω: ${player.name}`, 'success');
                } else {
                    logResult('‚ùå –û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏–≥—Ä–æ–∫–∞', 'error');
                    failTest();
                    return;
                }
                passTest();
            } catch (error) {
                logResult(`‚ùå –û—à–∏–±–∫–∞ PlayerManager: ${error.message}`, 'error');
                failTest();
            }
        };

        window.testStateManager = async function() {
            startTest();
            try {
                const stateManager = new StateManager();
                stateManager.setState({ test: 'value' });
                const state = stateManager.getState();
                
                if (state.test === 'value') {
                    logResult('‚úÖ StateManager —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ', 'success');
                } else {
                    logResult('‚ùå –û—à–∏–±–∫–∞ StateManager', 'error');
                    failTest();
                    return;
                }
                passTest();
            } catch (error) {
                logResult(`‚ùå –û—à–∏–±–∫–∞ StateManager: ${error.message}`, 'error');
                failTest();
            }
        };

        window.testPlayerStats = async function() {
            startTest();
            try {
                if (!window.gameCore) {
                    throw new Error('GameCore –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
                }
                
                const stats = window.gameCore.getGameStats();
                logResult('‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–≥—Ä—ã –ø–æ–ª—É—á–µ–Ω–∞', 'success');
                logResult(`  - –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã: ${JSON.stringify(stats)}`, 'success');
                passTest();
            } catch (error) {
                logResult(`‚ùå –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏: ${error.message}`, 'error');
                failTest();
            }
        };

        window.testFullGame = async function() {
            startTest();
            try {
                if (!window.gameCore) {
                    throw new Error('GameCore –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
                }
                
                // –°–æ–∑–¥–∞–µ–º –∏–≥—Ä–æ–∫–æ–≤
                const players = [
                    { id: '1', name: '–ò–≥—Ä–æ–∫ 1' },
                    { id: '2', name: '–ò–≥—Ä–æ–∫ 2' }
                ];
                
                // –í—ã–ø–æ–ª–Ω—è–µ–º 3 —Ö–æ–¥–∞
                for (let i = 0; i < 3; i++) {
                    const player = players[i % players.length];
                    const result = await window.gameCore.executeTurn(player.id);
                    logResult(`‚úÖ –•–æ–¥ ${i + 1} –≤—ã–ø–æ–ª–Ω–µ–Ω –∏–≥—Ä–æ–∫–æ–º ${player.name}`, 'success');
                }
                
                passTest();
            } catch (error) {
                logResult(`‚ùå –û—à–∏–±–∫–∞ –ø–æ–ª–Ω–æ–π –∏–≥—Ä—ã: ${error.message}`, 'error');
                failTest();
            }
        };

        window.testMultiplePlayers = async function() {
            startTest();
            try {
                if (!window.gameCore) {
                    throw new Error('GameCore –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
                }
                
                // –°–æ–∑–¥–∞–µ–º 4 –∏–≥—Ä–æ–∫–æ–≤
                const players = [
                    { id: '1', name: '–ò–≥—Ä–æ–∫ 1' },
                    { id: '2', name: '–ò–≥—Ä–æ–∫ 2' },
                    { id: '3', name: '–ò–≥—Ä–æ–∫ 3' },
                    { id: '4', name: '–ò–≥—Ä–æ–∫ 4' }
                ];
                
                // –í—ã–ø–æ–ª–Ω—è–µ–º –ø–æ –æ–¥–Ω–æ–º—É —Ö–æ–¥—É –∫–∞–∂–¥—ã–º –∏–≥—Ä–æ–∫–æ–º
                for (const player of players) {
                    const result = await window.gameCore.executeTurn(player.id);
                    logResult(`‚úÖ –•–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω –∏–≥—Ä–æ–∫–æ–º ${player.name}`, 'success');
                }
                
                passTest();
            } catch (error) {
                logResult(`‚ùå –û—à–∏–±–∫–∞ –º—É–ª—å—Ç–∏–ø–ª–µ–µ—Ä–∞: ${error.message}`, 'error');
                failTest();
            }
        };

        window.testPerformance = async function() {
            startTest();
            try {
                const startTime = performance.now();
                
                // –í—ã–ø–æ–ª–Ω—è–µ–º 100 –æ–ø–µ—Ä–∞—Ü–∏–π
                for (let i = 0; i < 100; i++) {
                    const diceModule = new DiceModule();
                    diceModule.roll();
                }
                
                const endTime = performance.now();
                const duration = endTime - startTime;
                
                logResult(`‚úÖ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 100 –æ–ø–µ—Ä–∞—Ü–∏–π –∑–∞ ${duration.toFixed(2)}ms`, 'success');
                logResult(`  - –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è: ${(duration / 100).toFixed(2)}ms –Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏—é`, 'success');
                passTest();
            } catch (error) {
                logResult(`‚ùå –û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏: ${error.message}`, 'error');
                failTest();
            }
        };

        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function startTest() {
            testStats.startTime = performance.now();
        }

        function passTest() {
            testStats.total++;
            testStats.passed++;
            updateStats();
        }

        function failTest() {
            testStats.total++;
            testStats.failed++;
            updateStats();
        }

        function updateStats() {
            document.getElementById('totalTests').textContent = testStats.total;
            document.getElementById('passedTests').textContent = testStats.passed;
            document.getElementById('failedTests').textContent = testStats.failed;
            
            if (testStats.startTime) {
                const duration = performance.now() - testStats.startTime;
                document.getElementById('testTime').textContent = `${duration.toFixed(0)}ms`;
            }
        }

        function logResult(message, type = 'info') {
            const logContainer = document.getElementById('testLogs');
            const logEntry = document.createElement('div');
            logEntry.className = `log-entry ${type}`;
            logEntry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            logContainer.appendChild(logEntry);
            logContainer.scrollTop = logContainer.scrollHeight;
        }

        window.clearResults = function() {
            document.getElementById('testLogs').innerHTML = '';
            testStats = { total: 0, passed: 0, failed: 0, startTime: null };
            updateStats();
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', async () => {
            logResult('üöÄ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ä–µ–¥—ã...', 'info');
            const success = await initModules();
            if (success) {
                logResult('‚úÖ –¢–µ—Å—Ç–æ–≤–∞—è —Å—Ä–µ–¥–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ!', 'success');
            } else {
                logResult('‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ä–µ–¥—ã', 'error');
            }
        });
    </script>
</body>
</html>
