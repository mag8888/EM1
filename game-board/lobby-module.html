<!DOCTYPE html>
<html lang="ru">
<head>
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="alternate icon" href="/favicon.ico">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–õ–æ–±–±–∏ - Game Board v2.6</title>
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="stylesheet" href="/assets/css/components/lobby.css">
</head>
<body>
    <div class="lobby-container">
        <main class="main-content">
            <header class="lobby-header">
                <h1 class="lobby-title">üéÆ –õ–û–ë–ë–ò</h1>
                <p class="lobby-subtitle">–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–º–Ω–∞—Ç—É –∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é –∏–≥—Ä—É</p>
            </header>

            <div class="lobby-actions">
                <button class="btn btn-primary create-room-btn">
                    üè† –°–æ–∑–¥–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É
                </button>
                <button class="btn btn-success quick-join-btn">
                    ‚ö° –ë—ã—Å—Ç—Ä—ã–π –≤—Ö–æ–¥
                </button>
                <button class="btn btn-secondary refresh-btn">
                    üîÑ –û–±–Ω–æ–≤–∏—Ç—å
                </button>
            </div>

            <section class="rooms-section">
                <div class="rooms-list" id="roomsList">
                    <!-- –ö–æ–º–Ω–∞—Ç—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
            </section>
        </main>

        <aside class="sidebar">
            <div class="panel">
                <h3>üë§ –ü—Ä–æ—Ñ–∏–ª—å</h3>
                <div class="user-info">
                    <div class="user-avatar" id="userAvatar">U</div>
                    <div class="user-details">
                        <h3 id="userName">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</h3>
                        <p>–û–Ω–ª–∞–π–Ω</p>
                    </div>
                </div>
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-value" id="userBalance">$0</div>
                        <div class="stat-label">–ë–∞–ª–∞–Ω—Å</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="totalGames">0</div>
                        <div class="stat-label">–ò–≥—Ä</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="totalWins">0</div>
                        <div class="stat-label">–ü–æ–±–µ–¥</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="userLevel">1</div>
                        <div class="stat-label">–£—Ä–æ–≤–µ–Ω—å</div>
                    </div>
                </div>
            </div>

            <div class="panel">
                <h3>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
                <div class="stat-item">
                    <div class="stat-value" id="onlinePlayers">1</div>
                    <div class="stat-label">–ò–≥—Ä–æ–∫–æ–≤ –æ–Ω–ª–∞–π–Ω</div>
                </div>
            </div>

            <div class="panel">
                <h3>üß™ –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã</h3>
                <div style="display: grid; gap: 10px; grid-template-columns: 1fr 1fr;">
                    <button class="btn btn-secondary" onclick="window.open('/', '_blank')" style="font-size: 12px;">
                        üè† –ì–ª–∞–≤–Ω–∞—è
                    </button>
                    <button class="btn btn-secondary" onclick="window.open('/auth', '_blank')" style="font-size: 12px;">
                        üîê –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
                    </button>
                    <button class="btn btn-secondary" onclick="window.open('/lobby', '_blank')" style="font-size: 12px;">
                        üéÆ –õ–æ–±–±–∏ (—Å—Ç–∞—Ä–æ–µ)
                    </button>
                    <button class="btn btn-secondary" onclick="window.open('/game', '_blank')" style="font-size: 12px;">
                        üéØ –ò–≥—Ä–∞
                    </button>
                    <button class="btn btn-secondary" onclick="window.open('/test', '_blank')" style="font-size: 12px;">
                        üî¨ –¢–µ—Å—Ç
                    </button>
                    <button class="btn btn-secondary" onclick="window.open('/docs', '_blank')" style="font-size: 12px;">
                        üìö –î–æ–∫—É–º–µ–Ω—Ç—ã
                    </button>
                </div>
            </div>

            <div class="panel">
                <h3>üîß API & Debug</h3>
                <div style="display: grid; gap: 8px; grid-template-columns: 1fr;">
                    <button class="btn btn-secondary" onclick="window.open('/api/health', '_blank')" style="font-size: 11px;">
                        üè• API Health
                    </button>
                    <button class="btn btn-secondary" onclick="window.open('/api/rooms', '_blank')" style="font-size: 11px;">
                        üè† API Rooms
                    </button>
                    <button class="btn btn-secondary" onclick="window.open('/api/user/profile', '_blank')" style="font-size: 11px;">
                        üë§ API Profile
                    </button>
                    <button class="btn btn-secondary" onclick="window.open('/api/user/stats', '_blank')" style="font-size: 11px;">
                        üìä API Stats
                    </button>
                    <button class="btn btn-secondary" onclick="testWebSocket()" style="font-size: 11px;">
                        üîå WebSocket Test
                    </button>
                </div>
            </div>

            <div class="panel">
                <h3>üåê –°—Å—ã–ª–∫–∏</h3>
                <div style="display: grid; gap: 8px; grid-template-columns: 1fr;">
                    <button class="btn btn-secondary" onclick="window.open('https://em1-production.up.railway.app/lobby-module', '_blank')" style="font-size: 11px;">
                        üöÄ Railway (–ü—Ä–æ–¥–∞–∫—à–Ω)
                    </button>
                    <button class="btn btn-secondary" onclick="window.open('http://localhost:3000/lobby-module', '_blank')" style="font-size: 11px;">
                        üíª Localhost
                    </button>
                    <button class="btn btn-secondary" onclick="copyCurrentUrl()" style="font-size: 11px;">
                        üìã –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å URL
                    </button>
                    <button class="btn btn-secondary" onclick="showSystemInfo()" style="font-size: 11px;">
                        ‚ÑπÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ
                    </button>
                </div>
            </div>

            <div class="panel">
                <button class="btn btn-secondary logout-btn" style="width: 100%;">
                    üö™ –í—ã–π—Ç–∏
                </button>
            </div>
        </aside>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–º–Ω–∞—Ç—ã -->
    <div class="modal" id="createRoomModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">–°–æ–∑–¥–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É</h2>
                <button class="close-btn">&times;</button>
            </div>
            <form id="createRoomForm">
                <div class="form-group">
                    <label for="roomName">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã</label>
                    <input type="text" id="roomName" required placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã">
                </div>
                <div class="form-group">
                    <label for="maxPlayers">–ú–∞–∫—Å–∏–º—É–º –∏–≥—Ä–æ–∫–æ–≤</label>
                    <select id="maxPlayers">
                        <option value="2">2 –∏–≥—Ä–æ–∫–∞</option>
                        <option value="3">3 –∏–≥—Ä–æ–∫–∞</option>
                        <option value="4" selected>4 –∏–≥—Ä–æ–∫–∞</option>
                        <option value="5">5 –∏–≥—Ä–æ–∫–æ–≤</option>
                        <option value="6">6 –∏–≥—Ä–æ–∫–æ–≤</option>
                        <option value="7">7 –∏–≥—Ä–æ–∫–æ–≤</option>
                        <option value="8">8 –∏–≥—Ä–æ–∫–æ–≤</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="turnTime">–í—Ä–µ–º—è –Ω–∞ —Ö–æ–¥ (–º–∏–Ω—É—Ç—ã)</label>
                    <select id="turnTime">
                        <option value="1">1 –º–∏–Ω—É—Ç–∞</option>
                        <option value="2">2 –º–∏–Ω—É—Ç—ã</option>
                        <option value="3" selected>3 –º–∏–Ω—É—Ç—ã</option>
                        <option value="4">4 –º–∏–Ω—É—Ç—ã</option>
                        <option value="5">5 –º–∏–Ω—É—Ç</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="assignProfessions"> –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–∑–Ω–∞—á–∞—Ç—å –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏
                    </label>
                </div>
                <div class="form-group">
                    <label for="roomPassword">–ü–∞—Ä–æ–ª—å –∫–æ–º–Ω–∞—Ç—ã (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
                    <input type="password" id="roomPassword" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å">
                </div>
                <div class="form-group">
                    <label>–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏—é</label>
                    <div class="profession-cards">
                        <div class="profession-card" data-profession="entrepreneur">
                            <div class="profession-icon">üíº</div>
                            <div class="profession-name">–ü—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å</div>
                        </div>
                        <div class="profession-card" data-profession="employee">
                            <div class="profession-icon">üëî</div>
                            <div class="profession-name">–°–æ—Ç—Ä—É–¥–Ω–∏–∫</div>
                        </div>
                        <div class="profession-card" data-profession="investor">
                            <div class="profession-icon">üìà</div>
                            <div class="profession-name">–ò–Ω–≤–µ—Å—Ç–æ—Ä</div>
                        </div>
                        <div class="profession-card" data-profession="freelancer">
                            <div class="profession-icon">üíª</div>
                            <div class="profession-name">–§—Ä–∏–ª–∞–Ω—Å–µ—Ä</div>
                        </div>
                    </div>
                </div>
                <div class="error-message" id="createRoomError"></div>
                <div class="loading" id="createRoomLoading">
                    <div class="spinner"></div>
                    <span>–°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã...</span>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary">–û—Ç–º–µ–Ω–∞</button>
                    <button type="submit" class="btn btn-primary">–°–æ–∑–¥–∞—Ç—å</button>
                </div>
            </form>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—Ö–æ–¥–∞ –≤ –∫–æ–º–Ω–∞—Ç—É -->
    <div class="modal" id="joinRoomModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">–í—Ö–æ–¥ –≤ –∫–æ–º–Ω–∞—Ç—É</h2>
                <button class="close-btn">&times;</button>
            </div>
            <div class="form-group">
                <label for="joinRoomPassword">–ü–∞—Ä–æ–ª—å –∫–æ–º–Ω–∞—Ç—ã</label>
                <input type="password" id="joinRoomPassword" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å (–µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è)">
            </div>
            <div class="error-message" id="joinRoomError"></div>
            <div class="loading" id="joinRoomLoading">
                <div class="spinner"></div>
                <span>–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...</span>
            </div>
            <div class="modal-actions">
                <button type="button" class="btn btn-secondary">–û—Ç–º–µ–Ω–∞</button>
                <button type="button" class="btn btn-primary">–í–æ–π—Ç–∏</button>
            </div>
        </div>
    </div>

    <!-- Socket.IO –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
    <script src="/socket.io/socket.io.js"></script>
    
    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –º–æ–¥—É–ª—è -->
    <script type="module" src="/game/assets/js/modules/lobby/index.js"></script>
    
    <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
    <script>
        function testWebSocket() {
            try {
                const socket = io({
                    transports: ['polling', 'websocket'],
                    timeout: 5000,
                    forceNew: true
                });
                
                socket.on('connect', () => {
                    alert('‚úÖ WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω —É—Å–ø–µ—à–Ω–æ! Socket ID: ' + socket.id);
                    socket.disconnect();
                });
                
                socket.on('connect_error', (error) => {
                    alert('‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è WebSocket: ' + error.message);
                });
                
                socket.on('disconnect', () => {
                    console.log('WebSocket –æ—Ç–∫–ª—é—á–µ–Ω');
                });
                
            } catch (error) {
                alert('‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è WebSocket: ' + error.message);
            }
        }
        
        function copyCurrentUrl() {
            navigator.clipboard.writeText(window.location.href).then(() => {
                alert('‚úÖ URL —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞: ' + window.location.href);
            }).catch(() => {
                alert('‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å URL');
            });
        }
        
        function showSystemInfo() {
            const info = `
üéÆ Game Board v2.6
üåê URL: ${window.location.href}
üïê –í—Ä–µ–º—è: ${new Date().toLocaleString('ru-RU')}
üì± User Agent: ${navigator.userAgent}
üîå WebSocket: ${typeof io !== 'undefined' ? '–î–æ—Å—Ç—É–ø–µ–Ω' : '–ù–µ–¥–æ—Å—Ç—É–ø–µ–Ω'}
üíæ LocalStorage: ${typeof localStorage !== 'undefined' ? '–î–æ—Å—Ç—É–ø–µ–Ω' : '–ù–µ–¥–æ—Å—Ç—É–ø–µ–Ω'}
            `;
            alert(info);
        }
        
        // –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤–µ—Ä—Å–∏–∏ –≤ –∫–æ–Ω—Å–æ–ª—å
        console.log('üéÆ LobbyModule v2.6 - –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–æ—Å—Ç—É–ø–Ω—ã');
        console.log('üì± –î–æ—Å—Ç—É–ø–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã:', [
            '/', '/auth', '/lobby', '/game', '/lobby-module', '/test', '/docs'
        ]);
        console.log('üîå API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:', [
            '/api/health', '/api/rooms', '/api/user/profile', '/api/user/stats'
        ]);
        console.log('üåê –°—Å—ã–ª–∫–∏:', {
            railway: 'https://em1-production.up.railway.app/lobby-module',
            localhost: 'http://localhost:3000/lobby-module'
        });
    </script>
</body>
</html>
