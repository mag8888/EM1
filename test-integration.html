<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å–∏—Å—Ç–µ–º –∫–∞—Ä—Ç–æ—á–µ–∫</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #1a1a1a;
            color: #fff;
            padding: 20px;
        }
        .test-section {
            background: #2a2a2a;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            border: 1px solid #444;
        }
        .success { color: #10b981; }
        .error { color: #ef4444; }
        .warning { color: #f59e0b; }
        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        .card {
            background: #333;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #555;
        }
    </style>
</head>
<body>
    <h1>üß™ –¢–µ—Å—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å–∏—Å—Ç–µ–º –∫–∞—Ä—Ç–æ—á–µ–∫</h1>
    
    <div class="test-section">
        <h2>üìä –°—Ç–∞—Ç—É—Å –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥—É–ª–µ–π</h2>
        <div id="moduleStatus"></div>
    </div>
    
    <div class="test-section">
        <h2>üíº –¢–µ—Å—Ç –∫–∞—Ä—Ç –ø—Ä–æ—Ñ–µ—Å—Å–∏–π</h2>
        <div id="professionTest"></div>
    </div>
    
    <div class="test-section">
        <h2>üÉè –¢–µ—Å—Ç –∫–∞—Ä—Ç —Å–¥–µ–ª–æ–∫</h2>
        <div id="cardsTest"></div>
    </div>
    
    <div class="test-section">
        <h2>üéØ –¢–µ—Å—Ç –¥–∞–Ω–Ω—ã—Ö –∏–≥—Ä–æ–∫–æ–≤</h2>
        <div id="playersTest"></div>
    </div>

    <!-- –ó–∞–≥—Ä—É–∂–∞–µ–º –º–æ–¥—É–ª–∏ -->
    <script src="assets/js/modules/game/ProfessionManager.js"></script>
    <script src="assets/js/modules/game/ProfessionUI.js"></script>
    <script src="assets/js/modules/game/CardManager.js"></script>
    <script src="assets/js/modules/game/CardUI.js"></script>
    <script src="game-board/professions-data.js"></script>
    
    <script>
        console.log('üß™ Starting integration test...');
        
        // –¢–µ—Å—Ç –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥—É–ª–µ–π
        function testModuleLoading() {
            const statusDiv = document.getElementById('moduleStatus');
            const modules = [
                { name: 'ProfessionManager', obj: window.ProfessionManager },
                { name: 'ProfessionUI', obj: window.ProfessionUI },
                { name: 'CardManager', obj: window.CardManager },
                { name: 'CardUI', obj: window.CardUI },
                { name: 'PROFESSIONS data', obj: window.PROFESSIONS }
            ];
            
            let html = '';
            modules.forEach(module => {
                const status = module.obj ? 'success' : 'error';
                const icon = module.obj ? '‚úÖ' : '‚ùå';
                html += `<div class="${status}">${icon} ${module.name}: ${module.obj ? '–ó–∞–≥—Ä—É–∂–µ–Ω' : '–ù–µ –Ω–∞–π–¥–µ–Ω'}</div>`;
            });
            
            statusDiv.innerHTML = html;
        }
        
        // –¢–µ—Å—Ç –∫–∞—Ä—Ç –ø—Ä–æ—Ñ–µ—Å—Å–∏–π
        function testProfessions() {
            const testDiv = document.getElementById('professionTest');
            
            if (window.ProfessionManager && window.PROFESSIONS) {
                try {
                    const manager = new ProfessionManager();
                    const professions = manager.getAllProfessions();
                    
                    let html = `<div class="success">‚úÖ ProfessionManager: ${professions.length} –ø—Ä–æ—Ñ–µ—Å—Å–∏–π –∑–∞–≥—Ä—É–∂–µ–Ω–æ</div>`;
                    html += `<div class="success">‚úÖ PROFESSIONS data: ${window.PROFESSIONS.length} –ø—Ä–æ—Ñ–µ—Å—Å–∏–π –≤ window</div>`;
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–µ 3 –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏
                    html += '<div class="card-grid">';
                    professions.slice(0, 3).forEach(prof => {
                        html += `
                            <div class="card">
                                <h4>${prof.icon} ${prof.name}</h4>
                                <p>–ó–∞—Ä–ø–ª–∞—Ç–∞: $${prof.salary.toLocaleString()}</p>
                                <p>–†–∞—Å—Ö–æ–¥—ã: $${prof.expenses.toLocaleString()}</p>
                                <p>–î–µ–Ω–µ–∂–Ω—ã–π –ø–æ—Ç–æ–∫: $${prof.cashFlow.toLocaleString()}</p>
                            </div>
                        `;
                    });
                    html += '</div>';
                    
                    testDiv.innerHTML = html;
                } catch (error) {
                    testDiv.innerHTML = `<div class="error">‚ùå –û—à–∏–±–∫–∞ ProfessionManager: ${error.message}</div>`;
                }
            } else {
                testDiv.innerHTML = '<div class="error">‚ùå ProfessionManager –∏–ª–∏ PROFESSIONS –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã</div>';
            }
        }
        
        // –¢–µ—Å—Ç –∫–∞—Ä—Ç —Å–¥–µ–ª–æ–∫
        function testCards() {
            const testDiv = document.getElementById('cardsTest');
            
            if (window.CardManager) {
                try {
                    const manager = new CardManager();
                    const stats = manager.getDeckStatistics();
                    
                    let html = '<div class="success">‚úÖ CardManager: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω</div>';
                    html += `<div class="success">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–ª–æ–¥:</div>`;
                    html += `<div class="card-grid">`;
                    
                    Object.entries(stats).forEach(([deck, count]) => {
                        html += `
                            <div class="card">
                                <h4>${deck}</h4>
                                <p>–ö–∞—Ä—Ç: ${count}</p>
                            </div>
                        `;
                    });
                    
                    html += '</div>';
                    testDiv.innerHTML = html;
                } catch (error) {
                    testDiv.innerHTML = `<div class="error">‚ùå –û—à–∏–±–∫–∞ CardManager: ${error.message}</div>`;
                }
            } else {
                testDiv.innerHTML = '<div class="error">‚ùå CardManager –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω</div>';
            }
        }
        
        // –¢–µ—Å—Ç –¥–∞–Ω–Ω—ã—Ö –∏–≥—Ä–æ–∫–æ–≤
        function testPlayers() {
            const testDiv = document.getElementById('playersTest');
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º localStorage
            const userId = localStorage.getItem('userId');
            const user = localStorage.getItem('user');
            
            let html = '';
            if (userId) {
                html += `<div class="success">‚úÖ User ID: ${userId}</div>`;
            } else {
                html += '<div class="warning">‚ö†Ô∏è User ID –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ localStorage</div>';
            }
            
            if (user) {
                try {
                    const userData = JSON.parse(user);
                    html += `<div class="success">‚úÖ User data: ${userData.username || 'Unknown'}</div>`;
                } catch (e) {
                    html += '<div class="error">‚ùå –û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ user data</div>';
                }
            } else {
                html += '<div class="warning">‚ö†Ô∏è User data –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ localStorage</div>';
            }
            
            testDiv.innerHTML = html;
        }
        
        // –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç—ã
        setTimeout(() => {
            testModuleLoading();
            testProfessions();
            testCards();
            testPlayers();
            
            console.log('üß™ Integration test completed');
        }, 1000);
    </script>
</body>
</html>